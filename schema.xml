<database name="spoilerwiki-local" defaultIdMethod="native" namespace="SpoilerWiki" identifierQuoting="true">
    <table name="artist" phpName="Artist">
        <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="name" type="varchar" size="255" required="true" />
        <column name="bio" type="longvarchar" required="false" />
    </table>
    <table name="canon" phpName="Canon">
        <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="name" type="varchar" size="255" required="true" />
        <column name="description" type="longvarchar" required="false" />
        <column name="primary_artist_id" type="integer" required="true"  />
        <!--foreign keys -->
        <foreign-key foreignTable="artist" phpName="primaryArtist">
            <reference local="primary_artist_id" foreign="id" />
        </foreign-key>
    </table>

    <table name="work" phpName="Work">
        <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="name" type="varchar" size="255" required="true" />
        <column name="description" type="longvarchar" required="false" />
        <column name="order" type="integer" required="true" defaultValue="0" />
        <column name="primary_artist_id" type="integer" required="true"  />
        <column name="canon_id" type="integer" required="true"  />
        <column name="work_type_id" type="integer" required="true"  />
        <!-- foreign keys -->
        <foreign-key foreignTable="artist" phpName="primaryArtist">
            <reference local="primary_artist_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="canon" phpName="canon">
            <reference local="canon_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="work_type" phpName="workType">
            <reference local="work_type_id" foreign="id" />
        </foreign-key>
    </table>

    <table name="work_type" phpName="WorkType">
        <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="name" type="varchar" size="255" required="true" />
        <column name="work_label" type="varchar" size="255" required="true" phpName="workLabel" />
        <column name="milestone_label" type="varchar" sixe="255" required="true" phpName="milestoneLabel" />
        <!-- foreign keys -->
    </table>

    <table name="milestone" phpName="Milestone">
        <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="order" type="integer" required="true" defaultValue="0" />
        <column name="label" type="varchar" require="false" />
        <column name="work_id" type="integer" required="true"  />
        <!--foreign keys -->
        <foreign-key foreignTable="work" phpName="work">
            <reference local="work_id" foreign="id" />
        </foreign-key>
    </table>
    <table name="topic" phpName="Topic">
        <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="name" type="varchar" size="255" required="true" />
        <column name="canon_id" type="integer" required="true"  />
        <column name="introduced_at" type="integer" required="true"  />
        <!-- foreign keys -->
        <foreign-key foreignTable="canon" phpName="canon">
            <reference local="canon_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="milestone" phpName="introducedAt">
            <reference local="introduced_at" foreign="id" />
        </foreign-key>
    </table>
    <table name="snippet" phpName="Snippet">
        <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="content" type="longvarchar" requred="true" />
        <column name="topic_id" type="integer" required="true"  />
        <column name="introduced_at" type="integer" required="true"  />
        <!-- foreign keys -->
        <foreign-key foreignTable="topic" phpName="topic">
            <reference local="topic_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="milestone" phpName="introducedAt">
            <reference local="introduced_at" foreign="id" />
        </foreign-key>
    </table>
    <table name="summary" phpName="Summary">
        <column name="id" type="integer" required="true" primaryKey="true" autoIncrement="true"/>
        <column name="content" type="longvarchar" required="true" />
        <column name="topic_id" type="integer" required="true"  />
        <column name="introduced_at" type="integer" required="true"  />
        <!-- foreign keys -->
        <foreign-key foreignTable="topic" phpName="topic">
            <reference local="topic_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="milestone" phpName="updatedAt">
            <reference local="introduced_at" foreign="id" />
        </foreign-key>
    </table>
</database>